# Critical Path E2E Test
#
# Covers the core user journey in a single flow:
# Auth > Home feed > Activity detail > Charts > Fitness > Training > Map > Routes > Settings

appId: com.veloq.app
tags:
  - tier1
---
# ── Launch & Auth ───────────────────────────────────────
- runFlow:
    file: helpers/setup-demo-mode-warm.yaml

# ── Home Feed ───────────────────────────────────────────
- assertVisible:
    id: "home-activity-list"

- extendedWaitUntil:
    visible: "RECENT ACTIVITIES"
    timeout: 15000

- tapOn:
    id: "activity-card-demo-.*"

# ── Activity Detail ─────────────────────────────────────
- extendedWaitUntil:
    visible:
      id: "activity-detail-screen"
    timeout: 15000

- assertVisible:
    id: "activity-detail-content"

- runFlow:
    when:
      visible:
        id: "chart-type-selector"
    commands:
      - tapOn:
          id: "chart-type-heartrate"
          optional: true
      - tapOn:
          id: "chart-type-power"
          optional: true
      - tapOn:
          id: "chart-type-elevation"
          optional: true

- back

# ── Fitness Tab ─────────────────────────────────────────
- runFlow:
    file: helpers/navigate-to-fitness.yaml

- assertVisible:
    id: "fitness-ctl-value"
    optional: true

- assertVisible:
    id: "fitness-atl-value"
    optional: true

# ── Training Tab ────────────────────────────────────────
- runFlow:
    file: helpers/navigate-to-training.yaml

- assertVisible:
    id: "weekly-summary"
    optional: true

# ── Map Tab ─────────────────────────────────────────────
- runFlow:
    file: helpers/navigate-to-map.yaml

- assertVisible:
    id: "map-fit-all"
    optional: true

# ── Routes Tab ──────────────────────────────────────────
- runFlow:
    file: helpers/navigate-to-routes.yaml

# ── Settings ────────────────────────────────────────────
- runFlow:
    file: helpers/navigate-to-settings.yaml

# ── Return to Home ──────────────────────────────────────
- openLink: "veloq://"

- extendedWaitUntil:
    visible:
      id: "home-screen"
    timeout: 10000

- assertVisible:
    id: "home-activity-list"
