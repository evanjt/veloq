# Stress Test: Map Marker Taps
# Tests tapping on activity markers rapidly

appId: com.veloq.app
tags:
  - tier3
---
- runFlow:
    file: helpers/setup-demo-mode.yaml

- runFlow:
    file: helpers/navigate-to-map.yaml

# Wait for map controls
- extendedWaitUntil:
    visible:
      id: "map-toggle-activities"
    timeout: 10000
    optional: true

# Tap on stable test activity marker
- tapOn:
    id: "map-activity-marker-demo-test-0"
    optional: true

- extendedWaitUntil:
    visible:
      id: "activity-popup"
    timeout: 3000
    optional: true

- tapOn:
    id: "activity-popup-view-details"
    optional: true

# Go back to map
- openLink: "veloq://map"

- extendedWaitUntil:
    visible:
      id: "map-screen"
    timeout: 10000

# Try tapping multiple markers rapidly
- repeat:
    times: 3
    commands:
      - tapOn:
          id: "map-activity-marker-demo-test-0"
          optional: true
      - tapOn:
          id: "map-activity-marker-demo-test-1"
          optional: true
      - tapOn:
          id: "map-activity-marker-demo-test-2"
          optional: true

# Verify map is still responsive
- assertVisible:
    id: "map-screen"

- takeScreenshot: "stress-map-marker-taps-complete"
